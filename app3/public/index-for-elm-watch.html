<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Elm-Watch</title>
  <style> body {margin: 0px; font-family: Verdana, Helvetica, Tahoma, Arial, sans-serif}</style>
</head>

<body>
  <script src="../elm-compiled-by-elm-watch/elm.js"></script>
  <script src="../src/elm-wrapper.js"></script>
  <script>
    let app;
    const handleString = (string) => {
        console.log(`Received by the host: "${string}"`)
    }
    const mount = () => {
        if (!app) {
            // Can also be initialized without arguments with `ElmWrapped.init()`
            // and the argument can be pussed later using `send`.
            app = ElmWrapped.init({
              flags: 
                { user: "megumi.suzuki"
                , language: "en-GB"
                }
            });
            // This subscription is useful to receive data from the application
            app.receive.subscribe(handleString);
            // Object can be sent this way. Only valid object will be considered.
            // `null` will be ignored.
            app.send(null);
            // `language` is a valid key
            app.send({ language: "it-IT" });
            // An object can contain multiple keys. Is values are set to `null`,
            // a default value will be used.
            app.send({ language: null, user: null });
            // A value will be overwritten if sent multiple times
            app.send({ user: "yoko.sato" });
            // Invalid keys or invalid values will be ignored
            app.send({ a: "1", b: "2" });
        }
    }
    const unmount = () => {
        if (app) {
            app.unmount()
            app.receive.unsubscribe(handleString);
            app = null;
        }
    }
  </script>
  <button onclick="mount()">Mount</button>
  <button onclick="unmount()">Unmount</button>
</body>

</html>